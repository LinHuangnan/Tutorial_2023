# 视觉组第四周考核任务

Author：@hyjack-00

| 版本 | 说明 |备注|
| ---- | ---- | ---- |
| v0.0.0 | 初始文档 | |
| v1.0.0 | 2023重构文档 | @hyjack-00 |

## 学习目标

这个任务需要预备队员重点掌握以下内容：

- 熟练掌握 OpenCV 的基础操作，学习视频图像处理的方法。
- C++ 程序的设计、编译与运行。
- 命令行参数的应用。

## 任务内容

用 C++ 实现一个基于 OpenCV 的视频背景还原器，从我们提供的测试样例视频中获得原背景。

### 具体要求

- 将处理代码编写在 `Recovery` 类中，分文件 `Recovery.h / Recovery.cpp` 对类进行定义/实现，基本符合面向对象编程的原则。类定义如下：

   ```cpp
   /*
   * public方法、属性不可变且必须实现
   * private方法、属性可自行增添
   * 主函数中必须使用public方法；
   */
   class Recovery {

   public:
       /* readVideo
       * @param filePath 文件绝对路径
       * 根据绝对路径读取需要还原背景的文件
       */
       void readVideo(String filePath);

       /* process
       * 进行还原过程
       */
       void process();

       /* showResult
       * 窗口展示背景还原后的结果
       */
       void showResult();

   private:

   };
   ```
   
- 题目提供了三个背景被物体遮挡的视频 (`./resource/*.mp4`)，程序每次只从运行时的命令行参数读取**一个**视频，还原出背景并使用图形窗口展示出来。

- 在命令行输出 `Recover.process()` 的处理时间（如 1.343s）。

- 使用 makefile 工具对程序进行编译。

- 符合团队代码规范。按照工程目录格式，分 `bin`，`build`，`src`，`include`，`resource` 文件夹，`makefile` 与这些文件夹同级。

- 使用 Markdown 为你的程序写一份清晰规范的说明文档，仍需要另一份报告记录你在本周考核过程中的关键步骤。

- 程序要求具有足够健壮性与通用性，尽量不要根据样例视频进行针对性的处理，在面对样例以外的视频也应该达到预期要求。（不作为评分标准）

- 注意！请不要使用 OpenCV 自带的 `cv::BackgroundSubtractor` 类及其子类等来完成任务！本任务旨在让大家熟悉 OpenCV 基本类和函数的使用，请自己开动脑筋使用基本库函数从头实现提取程序。

### 提示

- 可能会用到 OpenCV 的彩色像素值访问操作。

- 可能会用到 C++ 的 STL 库。

- 可能会用到统计的知识和方法。

- 计时推荐使用 `std::chrono`

- 三个样例视频位于本任务目录下的 `resource/`

### You May Try

额外加分项，视完成情况酌情加分，请有余力的同学尽情发挥：

- 加快算法处理速度。

- 自行拍摄现实视频进行测试并展示运行结果，如果有请将视频展示给我们（注意不要使用 github 上传大文件，你可以考虑线下展示）。

- 你可以使用 python 实现一个更复杂版本的程序，前提是你已经实现了一个有一定效果的 C++ 程序。如果用到请注明你的环境，包括 python 与主要库的版本。本要求对以下的加分项均成立。

- 将程序实现为 ROS 中的一个 package。

- 将程序实现为一个实时运行的程序，通过摄像头处理视频流（这要求你的程序处理速度够快）。

- 使用机器学习 / 深度学习方法，如果用到请附上数据集来源和训练代码。

- 使用 GPU 加速，如果用到请注明你的运行环境，包括硬件参数、驱动版本等。


### 效果参考

`video1.mp4` 结果如下：

![Result 1](resource/res1.jpg)

`video2.mp4` 结果如下：

![Result 2](resource/res2.png)

## 评分标准

前四个任务的评分都是阶梯式评分，不要担心没有完全还原出背景，尽你的所能完成即可~

| 评分项                       | 积分值   |
| ---------------------------- | -------- |
| 还原 `video1.mp4` 背景图      | 75分     |
| 还原 `video2.mp4` 背景图      | 90分     |
| 还原 `video3.mp4` 背景图      | 90分     |
| 编写说明文档                 | 30分     |
| 使用 `makefile` 成功编译运行  | 30分     |
| 输出程序运行计时              | 15分      |
| 额外加分项                   | 最高120分  |

本周负责人：黄宇杰

联系邮箱：huangyj285@mail2.sysu.edu.cn
